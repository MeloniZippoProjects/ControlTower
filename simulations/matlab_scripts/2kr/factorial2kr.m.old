function [ qs, SSx, SSE, fx, CI, std_devs ] = factorial2kr( combs, measures, alfa, graph_name )
%FACTORIAL2KR Summary of this function goes here
%   Detailed explanation goes here

    coeff_matrix = create_factorial_matrix(combs);
    
    two_k = size(combs,1);
    
    r = size(measures,2);
    
    mean_col = mean(measures.').';
    
    qs = (mean_col.' * coeff_matrix)/two_k;
    
    error_matrix = measures - mean_col;
    
    SSE = sum(sum(error_matrix.^2));
    
    SSx = (qs(2:length(qs)).^2)*two_k*r;
    
    SST = sum(SSx) + SSE;
    
    fx = SSx/SST;
    
    qq_fig = draw_qq_plot(error_matrix, graph_name);
    [std_fig, std_devs] = draw_residuals_plot(mean_col, error_matrix, graph_name);
    free_deg = two_k*(r-1);
    
    error_var = SSE/(free_deg);
    
    
    CI = -tinv(alfa/2,free_deg)*sqrt(error_var/(two_k*r));
end

